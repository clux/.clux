#!/usr/bin/env bash

giturl=$([ -z "$TRAVIS" ] && echo git@github.com:clux || echo https://github.com/clux)

cd && mkdir -p repos && cd repos

# private bitbucket repos
privates=(
  #deathmatch
  ssh
  #meshrtc
)
if [ -z "$TRAVIS" ]; then
  for i in ${privates[@]}
  do
    echo $i
    git clone git@bitbucket.org:clux/$i.git
done
git clone git@bitbucket.org:clux/dotcisco.git dotwork
git clone git@bitbucket.org:clux/ssh.git ~/ssh
mv ~/.ssh/* ~/ssh
rm -rf ~/.ssh
mv ~/ssh ~/.ssh
fi

# tournament related modules
cd && cd repos
mkdir tournament && cd tournament
trn=(
  duel
  #duel-names
  ffa
  ffa-tb
  group
  groupstage
  groupstage-tb
  groupstage-tb-duel
  masters
  roundrobin
  tiebreaker
  tournament
  tournament-components
  tourney
)
for i in ${trn[@]}
do
  git clone $giturl/$i.git
done

misc=(
  autonomy
  #badgify
  bandage
  blog
  cleverbot-irc
  combustion
  confortable
  curvefever-bot
  curvefever-stats
  decay
  deus-login
  dotclux
  dye
  gu
  icebreaker
  interlude
  irc-stream
  linkr-app
  linkr-components
  #logule
  mddocs
  npm-graph
  operators
  posts
  preservative
  sdp-transform
  smell
  splitter
  subset
  sulfur
  #symlink
  tabexplode
  tf2configs
  topiary
  trials
  tub
  unitednationsoftheworld
  vitae
  wolfram-alpha
  wolfram-irc
  wrappers
  xmpp-stream
  zalgolize
)

cd && cd repos

for i in ${misc[@]}
do
  echo $i
  git clone $giturl/$i.git
done

cd
symlink repos repos/tournament -g nodeunit -g jscoverage -g coveralls -g istanbul --execute

cd repos
git clone https://github.com/sstephenson/bats.git
cd bats
./install.sh /usr/local
