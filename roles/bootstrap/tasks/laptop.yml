---
# Laptop debian bootstrap

- name: Set console grub terminal
  lineinfile:
    dest=/etc/default/grub
    regexp="^#?GRUB_TERMINAL="
    line="GRUB_TERMINAL=console"
  notify: update-grub

- name: Add non-free sources
  lineinfile:
    dest=/etc/apt/sources.list
    regexp='^deb (\w*) jessie main$'
    line='deb \1 jessie main contrib non-free'
    backrefs=yes

- name: "Update cache"
  apt: update_cache=yes

- name: Install development dependencies
  apt: name={{ item }} state=installed
  with_items:
   - firmware-iwlwifi

# NB: install https://wiki.debian.org/NvidiaGraphicsDrivers separately
#aptitude -r install linux-headers-$(uname -r|sed 's,[^-]*-[^-]*-,,') nvidia-kernel-dkms
