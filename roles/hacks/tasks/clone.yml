---
# clone playbook - install stuff from git tags / source trees

- file: path=/home/{{ desktop_user }}/local/{{ item }} state=directory
  with_items:
  - share/man/man1
  - bin

- name: Clone blackbox
  git:
    repo: https://github.com/StackExchange/blackbox
    dest: /home/{{ desktop_user }}/local/blackbox
    version: stable
    update: "{{ upgrade_tasks | default(false) }}"

- name: make-install blackbox
  shell: make manual-install
  args:
    chdir: /home/{{ desktop_user }}/local/blackbox/
    creates: "/usr/local/bin/blackbox_cat"
    executable: /bin/bash

- name: Clone powerline fonts
  git:
    repo: https://github.com/powerline/fonts
    dest: /home/{{ desktop_user }}/local/powerline-fonts
    update: "{{ upgrade_tasks | default(false) }}"

- name: install powerline-fonts
  shell: ./install.sh
  args:
    chdir: /home/{{ desktop_user }}/local/powerline-fonts/
    creates: "/home/{{ desktop_user }}/.local/share/fonts/DejaVu\ Sans\ Mono\ for\ Powerline.ttf"

# Exists on AUR as z, but not on debian
- name: Clone z
  git:
    repo: https://github.com/rupa/z
    dest: /home/{{ desktop_user }}/local/z
    update: "{{ upgrade_tasks | default(false) }}"

# only thing z needs to install is z.1
# otherwise relies on sourcing ./z/z.sh from bash_profile
- name: link z.1
  file:
    src=/home/{{ desktop_user }}/local/z/z.1
    dest=/home/{{ desktop_user }}/local/share/man/man1/z.1
    state=link
    force=yes
